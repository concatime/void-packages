# Template file for 'folly'
pkgname=folly
version=2020.11.23.00
revision=1
build_style=cmake
configure_args="-D BUILD_SHARED_LIBS=ON -D BUILD_TESTS=OFF
 -D PACKAGE_VERSION=0.58.0"
makedepends="binutils-devel boost-devel bzip2-devel double-conversion-devel
 fmt-devel gflags-devel glog-devel jemalloc-devel libaio-devel libevent-devel
 liblz4-devel liblzma-devel libressl-devel libsodium-devel liburing-devel
 libzstd-devel snappy-devel zlib-devel $(vopt_if debug glibc-devel)
 $(vopt_if debug libdwarf-devel) $(vopt_if debug libunwind-devel)"
checkdepends="gtest-devel"
short_desc="Variety of core library components used extensively at Facebook"
maintainer="Issam E. Maghni <issam.e.maghni@mailbox.org>"
license="Apache-2.0"
homepage="https://github.com/facebook/folly"
distfiles="https://github.com/facebook/folly/archive/v${version}.tar.gz"
checksum=28940c49c92df15e061e51323be7d1879eaa095f13a715b1e8c0600e4e51bc19
patch_args="-Np1"

build_options="debug"
desc_option_debug="Enable advanced debugging functionality"

folly-devel_package() {
	short_desc+=" - development files"
	depends="${sourcepkg}>=${version}_${revision} boost-devel fmt-devel
	 jemalloc-devel"
	pkg_install() {
		vmove usr/include
		vmove "usr/lib/*.so"
		vmove usr/lib/cmake
		vmove usr/lib/pkgconfig
	}
}
